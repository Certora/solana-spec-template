##------------------------------------------------------------------------##
## This script is intended to be run only once during the project setup
##------------------------------------------------------------------------##

certora-scripts := "."

export HEADER := '''
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; DO NOT EDIT. THIS FILE HAS BEEN AUTOMATICALLY GENERATED
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;
;;
'''

core_inliner_cfg := certora-scripts  / "cvlr_inlining_core.txt"
anchor_inliner_cfg := certora-scripts  / "cvlr_inlining_anchor.txt"
package_inliner_cfg := certora-scripts  / "cvlr_inlining_package.txt"
inliner_cfg   := certora-scripts  / "cvlr_inlining.txt"

core_summaries_cfg := certora-scripts  / "cvlr_summaries_core.txt"
anchor_summaries_cfg := certora-scripts  / "cvlr_summaries_anchor.txt"
package_summaries_cfg := certora-scripts  / "cvlr_summaries_package.txt"
summaries_cfg := certora-scripts  / "cvlr_summaries.txt"

refresh:
  # download core and anchor files
  #curl -o filename raw-link-to-file

make-header:
  printf %s "$HEADER" > {{ inliner_cfg }}
  printf %s "$HEADER" > {{ summaries_cfg }}

make-envs: make-header
	cat {{ core_inliner_cfg }} {{ anchor_inliner_cfg }} {{ package_inliner_cfg }} >> {{ inliner_cfg }}
	cat {{ core_summaries_cfg }} {{ anchor_summaries_cfg }} {{ package_summaries_cfg }} >> {{ summaries_cfg }}
	
clean:
        rm -f {{ inliner_cfg }}
        rm -f {{ summaries_cfg }}

build: make-envs

rebuild: refresh build



